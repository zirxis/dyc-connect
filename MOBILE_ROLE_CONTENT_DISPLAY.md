# نافذة اختيار الدور مع عرض المحتوى - النسخة المحسنة

## الملخص
تم تحسين نافذة اختيار الدور للجوال لتعرض محتوى الدور المختار مباشرة داخل النافذة نفسها، مما يوفر تجربة سلسة وكاملة دون الحاجة لإغلاق النافذة.

## الميزات الجديدة

### 1. نافذة متعددة المراحل (Multi-Step)
النافذة الآن لها مرحلتين:

**المرحلة 1: اختيار الدور**
- عرض جميع الأدوار الـ 5
- اختيار دور واحد
- زر "المتابعة" للانتقال للمرحلة التالية

**المرحلة 2: عرض محتوى الدور**
- عرض محتوى لوحة التحكم الخاص بالدور المختار
- جميع البطاقات والمعلومات مرئية
- زر "رجوع" للعودة لاختيار دور آخر

### 2. سلوك الانتقال
```
المستخدم ينقر على بطاقة دور
    ↓
تظهر النافذة المنفصلة مع جميع الأدوار
    ↓
المستخدم ينقر على دور (يصبح مميز بلون أزرق)
    ↓
يظهر زر "المتابعة"
    ↓
المستخدم ينقر "المتابعة"
    ↓
تنتقل النافذة للمرحلة 2 (محتوى الدور)
    ↓
عرض محتوى لوحة التحكم الكامل
    ↓
المستخدم يستطيع:
   - قراءة المعلومات
   - النقر على "رجوع" لاختيار دور آخر
   - إغلاق النافذة برقم التقاطع
```

### 3. المحتوى المعروض

كل دور له محتوى مخصص:

#### أم (Mother)
- تقدم أطفالي (رسم بياني)
- الأدوات الذكية (ملخص الدروس، خريطة ذهنية)
- الجلسات القادمة

#### معلم (Teacher)
- الحالات المعلقة (قائمة الطلاب)
- الطلاب النشطين (رسم بياني)
- أدوات التقييم

#### مختص (Specialist)
- الإحالات الجديدة
- جلسات اليوم
- التقارير المهنية

#### مؤسسة (Institution)
- فريق العمل والإحصائيات
- الإحصائيات الشهرية
- التقارير والتحليلات

#### باحث (Researcher)
- طلبات البحث
- قاعدة البيانات
- التعاون البحثي

## المكونات التقنية

### HTML Structure
```html
<!-- المرحلة 1: اختيار الدور -->
<div id="role-selection-step">
    <!-- قائمة الأدوار وأزرار المتابعة -->
</div>

<!-- المرحلة 2: عرض المحتوى -->
<div id="role-content-step" style="display: none;">
    <div id="role-content-body">
        <!-- محتوى الدور سيتم ملأه بـ JavaScript -->
    </div>
</div>
```

### CSS Styles for Content Display

```css
/* منطقة محتوى الدور */
#role-content-body {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-height: 400px;
    overflow-y: auto;
}

/* بطاقات المحتوى */
#role-content-body .bg-white {
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    padding: 1rem;
    border-radius: 12px;
}

/* تفاعل النقر */
#role-content-body .bg-white:active {
    background: #f3f4f6;
    border-color: #00AEEF;
}

/* الأزرار داخل المحتوى */
#role-content-body button {
    padding: 0.75rem 1rem;
    background: #f3f4f6;
    border-radius: 8px;
    transition: all 0.3s ease;
}

#role-content-body button:active {
    background: #e5e7eb;
    border-color: #00AEEF;
    transform: scale(0.98);
}
```

### JavaScript Functions

#### `continueWithRole()`
الانتقال من مرحلة الاختيار إلى عرض المحتوى
```javascript
function continueWithRole() {
    // 1. الحصول على عنوان الدور
    const roleTitles = {
        mother: 'لوحة تحكم الأم',
        teacher: 'لوحة تحكم المعلم',
        // ...
    };
    
    // 2. الحصول على محتوى الدور
    const roleContent = getRoleSpecificContent(selectedRoleForModal);
    
    // 3. تحديث عنوان النافذة
    document.getElementById('role-content-title').textContent = roleTitles[...];
    
    // 4. إدراج المحتوى في النافذة
    document.getElementById('role-content-body').innerHTML = roleContent;
    
    // 5. إظهار المرحلة 2 بتأثير انزلاق
    // (إخفاء المرحلة 1 وإظهار المرحلة 2)
}
```

#### `backToRoleSelection()`
العودة من عرض المحتوى إلى اختيار الدور
```javascript
function backToRoleSelection() {
    // 1. إخفاء محتوى الدور
    document.getElementById('role-content-step').style.display = 'none';
    
    // 2. إظهار قائمة الأدوار
    document.getElementById('role-selection-step').style.display = 'block';
    
    // 3. إعادة تعيين الاختيار
    selectedRoleForModal = null;
    document.getElementById('continue-btn').style.display = 'none';
}
```

### التأثيرات البصرية

1. **الانتقال بين المراحل**: تأثير opacity من 0 إلى 1
2. **تحديد الدور**: حد أزرق وخلفية زرقاء فاتحة
3. **النقر على الأزرار**: تأثير scale(0.95)
4. **Scroll**: نطاق 400px أقصى ارتفاع مع scroll عمودي

## تجربة المستخدم

### على الجوال
1. ✅ تجربة كاملة بدون مغادرة النافذة
2. ✅ حجم نافذة مناسب (90% من عرض الشاشة)
3. ✅ محتوى قابل للتمرير (scroll)
4. ✅ أزرار كبيرة وسهلة الضغط (48px على الأقل)
5. ✅ زر رجوع واضح لتغيير الاختيار

### على سطح المكتب
- ✅ النافذة مخفية تماماً
- ✅ السلوك الأصلي: الانتقال الفوري للوحة التحكم

## الخصائص المرئية

### النافذة
- العرض الأقصى: 400px
- الارتفاع: 90vh (90% من ارتفاع الشاشة)
- الحد الأقصى للمحتوى: 400px بـ overflow-y: auto
- الخلفية: شفافة سوداء (opacity: 0.6)
- التأثير: slideUpModal عند الظهور

### المحتوى
- المسافات بين العناصر: 1rem (16px)
- الحشوة: 1rem (16px)
- نصف قطر الزوايا: 12px للبطاقات
- الألوان: رمادي فاتح (#f9fafb) مع حد رمادي (#e5e7eb)

## الملاحة

### أزرار المرحلة 1
```
[المتابعة] [إلغاء]
```

### أزرار المرحلة 2
```
[رجوع]
```

أيضاً: زر ✕ في رأس النافذة لإغلاق النافذة من أي مرحلة

## الاستجابة على التفاعلات

| الحدث | التأثير |
|------|--------|
| نقر على دور | تحديث لون الحد والخلفية لون أزرق |
| نقر على "المتابعة" | انتقال سلس للمرحلة 2 مع animation |
| نقر على "رجوع" | العودة للمرحلة 1 |
| نقر على ✕ | إغلاق النافذة الكاملة |
| scroll في المحتوى | تمرير سلس للمحتوى الطويل |

## الأداء

- **وقت الانتقال**: 300ms (سلس وسريع)
- **عدد استدعاءات DOM**: قليل جداً
- **حجم JavaScript**: لا توجد مكتبات إضافية
- **التوافقية**: جميع متصفحات الجوال الحديثة

## الاختبار

### السيناريو 1: الاستخدام الطبيعي
```
1. الضغط على "أم" من الشاشة الرئيسية
2. تظهر النافذة مع قائمة الأدوار
3. الضغط على "أم" في النافذة
4. تتحول النافذة لعرض محتوى الأم
5. قراءة المعلومات (تقدم الأطفال، الأدوات، الجلسات)
6. إغلاق النافذة برقم التقاطع أو الضغط على الخلفية
```

### السيناريو 2: تغيير الاختيار
```
1. الضغط على "أم" من الشاشة الرئيسية
2. تظهر النافذة
3. الضغط على "معلم"
4. الضغط على "المتابعة"
5. عرض محتوى المعلم
6. الضغط على "رجوع"
7. العودة لقائمة الأدوار
8. الضغط على "باحث" هذه المرة
9. الضغط على "المتابعة"
10. عرض محتوى الباحث
```

## التحسينات المستقبلية

- [ ] إضافة search في المحتوى الطويل
- [ ] إضافة favorites لتصفح سريع
- [ ] حفظ آخر دور مختار
- [ ] تصوير محتوى الدور (screenshot)
- [ ] مشاركة المحتوى
- [ ] نمط dark للنافذة
